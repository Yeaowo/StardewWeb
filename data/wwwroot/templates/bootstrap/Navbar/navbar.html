<script>
    var strStopTime = "Stop Time";
    var strStartTime = "Start Time";


</script>
<div class="container">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#"><span data-bind="text: Name" class="p-2" style="font-family: stardewwood; font-size: 28pt;color: orange; white-space:nowrap">Stardew Web</span></a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <!--
    <nav class="navbar">

            <button class="" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav1" aria-controls="navbarNav1" aria-expanded="false" aria-label="Toggle navigation">
                <span class="glyphicon-search"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav1">
                <form class="form-inline">
                    <input class="form-control" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
                </form>
            </div>
        </nav>
                -->
        <div class="collapse navbar-collapse" id="navbarNav">

            <ul class="navbar-nav">
                <li class="nav-item active">
                    <a class="nav-link" href="/" data-i18n="navbar.home">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/home/farmer" data-i18n="navbar.farmer">Farmer</a>
                </li>
            </ul>

        </div>


    </nav>

        <!--
        <nav class="navbar navbar-dark bg-dark fixed-top" role="navigation" style="height:110px;">
            <table style="height:55px;">
                <tr>
                    <td>
                        <div class="navbar-header" style="padding: 8px 0px 3px 5px; overflow-x:auto;">
                            <a class="navbar-brand" href="/"></a>
                        </div>
                    </td>

                    <td>
                        <div id="navbar" class="">
                            <table>
                                <tr>
                                    <td>
                                        <ul class="nav">
                                            #NAVBARITEMS#
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <ul class="nav">
                                            #SUBBARITEMS#
                                        </ul>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </td>
                </tr>
            </table>
            -->
</div>
<div class="container">
    <div class="status_bar" style="">
        #NAVBUTTONS#
    </div>
</div>
<div class="container">
    <div class="status_bar" style="">
        <div class="row row-cols-md-8 row-cols-sm-4">
            <div class="col-lg-2 col-md-3 col-6 p-0" data-i18n="hud.balance">Current Balance</div><div class="col-lg-1 col-md-2 col-5 hud_data-bs" id="hud_balance">#MONEY#</div>
            <div class="col-lg-1 col-md-1 col-6 p-0" data-i18n="hud.year">Year</div><div class="col-lg-1 col-5 col-md-1 hud_data-bs" id="hud_year">#YEAR#</div>
            <div class="col-lg-1 col-md-2 col-6 p-0" data-i18n="hud.season">Season</div><div class="col-lg-1 col-5 col-md-2 hud_data-bs" id="hud_season">#SEASON#</div>
            <div class="col-lg-1 col-md-1 col-6 p-0" data-i18n="hud.day">Day</div><div class="col-lg-1 col-5 col-md-2 hud_data-bs" id="hud_daytext">#DAYDATE#</div>
            <div class="col-lg-1 col-md-1 col-6 p-0" data-i18n="hud.time">Time</div><div class="col-lg-1 col-5 col-md-2 hud_data-bs" id="hud_tod">#TOD#</div>

        </div>
        #SEARCH#
        #GINGER#

    </div>
</div>


<!--
</nav>
    -->
<div class="popuptext base_font" id="myPopup" onclick="ClosePopup();" style="padding:20px; z-index:99100000;"><div id="popuptext" style="height:120px;overflow:auto;"></div><button onclick="ClosePopup();" data-i18n="ui.ok">Ok</button></div>

<div class="lookuptext base_font" id="myLookup" style="padding: 20px; cursor: default; position: fixed; background-image: url(/images/search_with_details.png); background-size: contain; z-index: 999999;">
    <div style="padding-top:10px; padding-right:2px;">

        <div class="search_container">
            <button class="search_close_button" onclick="CloseLookup();" data-i18n="ui.close">Close</button>
            <div class="search_text">
                <span data-i18n="ui.itemtosearch">Item to search for:</span> <input type="text" size="30" id="lookupquery" placeholder="Use an '*' for wild card search" data-i18n-placeholder="ui.searchplaceholder" />
                <button onclick="QueryForItem();" data-i18n="ui.search">Search</button><button onclick="GetPreviousPage();" style="font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif"><</button><button onclick="GetNextPage();" style="font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif">></button>
            </div>
        </div>
    </div>
    <img src="/images/wait.gif" id="waitgif" class="search_busy" title="Search Busy Iamge" />
    <div id="lookuptext" class="search_results">
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const applyTranslations = (translations) => {
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[key]) {
                    element.innerText = translations[key];
                }
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[key]) {
                    element.placeholder = translations[key];
                }
            });

            // Translate script variables
            if (translations['ui.stoptime']) {
                strStopTime = translations['ui.stoptime'];
            }
            if (translations['ui.starttime']) {
                strStartTime = translations['ui.starttime'];
            }
        };

        const fetchTranslations = async (lang) => {
            try {
                // We default to 'default' and then try to fetch a specific language file.
                // This ensures that even if a key is missing in 'zh-cn', the english version is shown.
                const defaultResponse = await fetch(`/i18n/default.json`);
                let translations = {};
                if (defaultResponse.ok) {
                    translations = await defaultResponse.json();
                }

                if (lang !== 'default') {
                    const response = await fetch(`/i18n/${lang}.json`);
                    if (response.ok) {
                        const langTranslations = await response.json();
                        Object.assign(translations, langTranslations); // Merge, specific language overrides default
                    } else {
                        console.warn(`Translation file for ${lang} not found.`);
                    }
                }
                applyTranslations(translations);

            } catch (error) {
                console.error('Error loading translation file:', error);
            }
        };

        const userLang = navigator.language || navigator.userLanguage;
        if (userLang.startsWith('zh')) {
            fetchTranslations('zh-cn');
        } else {
            fetchTranslations('default');
        }
    });
</script>

